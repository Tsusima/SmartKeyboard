import keyboard
import webbrowser
import tkinter as tk
from tkinter import *
from tkinter import messagebox
from tkinter.ttk import Radiobutton
from time import sleep
from tkinter.messagebox import showinfo

# def web_link1():
#     try:
#         with open("check_file.txt", "a", encoding="utf-8") as my_file:
#             if selected.get() == 1:
#                 sleep(0.25)
#                 key = keyboard.read_hotkey(suppress=False)
#                 key_list_1 = list(key)
#                 for i, item in enumerate(key_list_1, start=1):
#                     my_file.write(f"{i}: {item}\n")
#                 keyboard.add_hotkey("ctrl + win + NumLock", lambda: keyboard.press(key))
#                 lbl1_2.configure(text=key)
#             elif selected.get() == 2:
#                 my_file.write(f"{EnterText1.get()}\n")
#                 keyboard.add_hotkey("ctrl + win + NumLock", lambda: keyboard.release(webbrowser.open_new_tab(EnterText1.get())))
#                 lbl1_2.configure(text="Вы сохранили ссылку на клавишу")
#             elif selected.get() == 3:
#                 lbl1_2.configure(text="Вы удалили комбинацию/ссылку(и) на клавише")
#     except Exception as e:
#         messagebox.showerror("Ошибка", str(e))

def web_link1():
    try:
        if selected.get() == 1:
            sleep(0.25)
            key = keyboard.read_hotkey(suppress=False)
            key_list_1 = list(key)
            with open("check_file.txt", "a", encoding="utf-8") as my_file:
                for i, item in enumerate(key_list_1, start=1):
                    my_file.writelines(f"{i}: {key_list_1}\n")
                    # my_file.writelines([f"{__enumertate1__}: {key_list_1}\n"])
            keyboard.add_hotkey("ctrl + win + NumLock", lambda: keyboard.press(key))
            lbl1_2.configure(text=key)
        if selected.get() == 2:
            with open("check_file.txt", "a", encoding="utf-8") as my_file:
                my_file.writelines([f"{EnterText1.get()}\n"])
            keyboard.add_hotkey("ctrl + win + NumLock",
                                lambda: keyboard.release(webbrowser.open_new_tab(EnterText1.get())))
            lbl1_2.configure(text="Вы сохранили ссылку на клавишу")
        if selected.get() == 3:
            lbl1_2.configure(text="Вы удалили комбинацию/ссылку(и) на клавише")
    except Exception as e:
        messagebox.showerror("Ошибка", str(e))


def web_link2():
    try:
        __enumertate2__ = 0
        if selected.get() == 4:
            __enumertate2__ += 1
            sleep(0.25)
            key = keyboard.read_hotkey(suppress=False)
            key_list_2 = list(key)
            with open("check_file.txt", "a", encoding="utf-8") as my_file:
                my_file.writelines([f"{__enumertate2__}: {key_list_2}\n"])
            keyboard.add_hotkey("ctrl + win + PageUp", lambda: keyboard.press(key))
            lbl2_2.configure(text=key)
        if selected.get() == 5:
            with open("check_file.txt", "a", encoding="utf-8") as my_file:
                my_file.writelines([f"{EnterText2.get()}\n"])
            keyboard.add_hotkey("ctrl + win + PageUp",
                                lambda: keyboard.release(webbrowser.open_new_tab(EnterText2.get())))
            lbl2_2.configure(text="Вы сохранили ссылку на клавишу")
        if selected.get() == 6:
            lbl2_2.configure(text="Вы удалили комбинацию/ссылку(и) на клавише")
    except Exception as e:
        messagebox.showerror("Ошибка", str(e))


def web_link3():
    try:
        __enumertate3__ = 0
        if selected.get() == 7:
            __enumertate3__ += 1
            sleep(0.25)
            key = keyboard.read_hotkey(suppress=False)
            key_list_3 = list(key)
            with open("check_file.txt", "a", encoding="utf-8") as my_file:
                my_file.writelines([f"{__enumertate3__}: {key_list_3}\n"])
            keyboard.add_hotkey("ctrl + win + PageDown", lambda: keyboard.press(key))
            lbl3_2.configure(text=key)
        if selected.get() == 8:
            with open("check_file.txt", "a", encoding="utf-8") as my_file:
                my_file.writelines([f"{EnterText3.get()}\n"])
            keyboard.add_hotkey("ctrl + win + PageDown",
                                lambda: keyboard.release(webbrowser.open_new_tab(EnterText3.get())))
            lbl3_2.configure(text="Вы сохранили ссылку на клавишу")
        if selected.get() == 9:
            lbl3_2.configure(text="Вы удалили комбинацию/ссылку(и) на клавише")
    except Exception as e:
        messagebox.showerror("Ошибка", str(e))


def web_link4():
    try:
        __enumertate4__ = 0
        if selected.get() == 10:
            __enumertate4__ += 1
            sleep(0.25)
            key = keyboard.read_hotkey(suppress=False)
            key_list_4 = list(key)
            with open("check_file.txt", "a", encoding="utf-8") as my_file:
                my_file.writelines([f"{__enumertate4__}: {key_list_4}\n"])
            keyboard.add_hotkey("ctrl + win + PageDown", lambda: keyboard.press(key))
            lbl4_2.configure(text=key)
        if selected.get() == 11:
            with open("check_file.txt", "a", encoding="utf-8") as my_file:
                my_file.writelines([f"{EnterText4.get()}\n"])
            keyboard.add_hotkey("ctrl + alt + shift + win + 4",
                                lambda: keyboard.release(webbrowser.open_new_tab(EnterText4.get())))
            lbl4_2.configure(text="Вы сохранили ссылку на клавишу")
        if selected.get() == 12:
            lbl4_2.configure(text="Вы удалили комбинацию/ссылку(и) на клавише")
    except Exception as e:
        messagebox.showerror("Ошибка", str(e))


def on_closing():
    try:
        if messagebox.askokcancel("Выход из приложения", "Хотите выйти из приложения?"):
            window.destroy()
    except Warning:
        return


def open_info():
    try:
        showinfo(title="Инструкция", message=f'''1) Если вы хотите сохрнать комбинацию на выбранную клавишу выполните следующие дейстивя:
    • Шаг 1-ый, Выберите кнопку <<Комбинация>>.
    • Шаг 2-ой, Нажмите на кнопку <<Записать>> и затем введите комбинцию.
    • Выполнив эти шаги, вы увидите записанную комбинацию в соответвующем поле, что будет свидетельствовать о успешно сохранении комбинации.


2) Если вы хотите сохрнать ссылку на выбранную клавишу выполните следующие дейстивя:
    • Шаг 1-ый, Выберите кнопку <<Ссылка>>.
    • Шаг 2-ой, Скопируйте ссылку из браузера.
    • Шаг 3-ий, Вставьте ссылку в соответсвенное поле для ввода и нажмите на клавишу <<Записать>>. 
    • Выполнив эти шаги, вы увидите сообщении об успешном сохранении ссылки в соответвующем поле.
    • Примичание: Вы можете сохранить на одну клавишу сразу несколько ссылок, для этого после того как вы сохранили первую ссылку, сотрите её и вставьте новую, после нажмите на клавишу <<Записать>>.
    • Внимание! Не рекомендуем сохранять слишком большое количесво ссылок на одну клавишу!


3) Если вы хотите удалить комбинацию или ссылку с клавиши, выполните следующие действия:
    • Шаг 1-ый, Выберите кнопку <<Удалить>>.
    • Шаг 2-ой, Нажмите кнопку <<Записать>>.
    • Выполнив эти шаги, вы увидите сообщении об удалении комбинации/ссылки в соответвующем поле.
''')
    except Exception as e:
        messagebox.showerror("Ошибка", str(e))


# тело приложения
window = tk.Tk()
window.protocol("WM_DELETE_WINDOW", on_closing)
window.title("Приложение")
window.resizable(width=False, height=False)
window.wm_attributes("-topmost")
window.geometry('700x700')
window["bg"] = "gray"
# idea = tk.Label(window, text="Название Программы", font=("Arial Bold", 15), fg="white", bg="gray")
# idea.place(x=270, y=25)

# отображение комбинации клавиш которую сохранил или когда ничего не сохраниили
lbl1_2 = tk.Label(window, width="40", height="5")
lbl1_2.place(x=350, y=65)

lbl2_2 = tk.Label(window, width="40", height="5")
lbl2_2.place(x=350, y=181)

lbl3_2 = tk.Label(window, width="40", height="5")
lbl3_2.place(x=350, y=291)

lbl4_2 = tk.Label(window, width="40", height="5")
lbl4_2.place(x=350, y=401)

# кнопока инструкции
btn_info = tk.Button(window, text="Инструкция", command=open_info, width="10", height="2",
                     fg="black", bg="#1faee9")
btn_info.place(x=10, y=10)

# кнопоки записи
EnterText1 = tk.Entry(fg="black", width=40)
EnterText1.place(x=1, y=65)
btn1 = tk.Button(window, text="Записать", command=web_link1, width="40", height="2",
                 fg="black", bg="white")
btn1.place(x=1, y=105)

EnterText2 = tk.Entry(fg="black", width=40)
EnterText2.place(x=1, y=181)
btn2 = tk.Button(window, text="Записать", command=web_link2, width="40", height="2",
                 fg="black", bg="white")
btn2.place(x=1, y=220)

EnterText3 = tk.Entry(fg="black", width=40)
EnterText3.place(x=1, y=291)
btn3 = tk.Button(window, text="Записать", command=web_link3, width="40", height="2",
                 fg="black", bg="white")
btn3.place(x=1, y=330)

EnterText4 = tk.Entry(fg="black", width=40)
EnterText4.place(x=0, y=401)
btn4 = tk.Button(window, text="Записать", command=web_link4, width="40", height="2",
                 fg="black", bg="white")
btn4.place(x=1, y=440)

# выбор для пользователя

selected = IntVar()
rad1 = Radiobutton(window, text='Комбинация', value=1, variable=selected)
rad2 = Radiobutton(window, text='Сылка', value=2, variable=selected)
rad3 = Radiobutton(window, text='Удалить', value=3, variable=selected)

rad1.place(x=1, y=84)
rad2.place(x=94, y=84)
rad3.place(x=153, y=84)

rad4 = Radiobutton(window, text='Комбинация', value=4, variable=selected)
rad5 = Radiobutton(window, text='Сылка', value=5, variable=selected)
rad6 = Radiobutton(window, text='Удалить', value=6, variable=selected)

rad4.place(x=1, y=200)
rad5.place(x=94, y=200)
rad6.place(x=153, y=200)

rad7 = Radiobutton(window, text='Комбинация', value=7, variable=selected)
rad8 = Radiobutton(window, text='Сылка', value=8, variable=selected)
rad9 = Radiobutton(window, text='Удалить', value=9, variable=selected)

rad7.place(x=1, y=310)
rad8.place(x=94, y=310)
rad9.place(x=153, y=310)

rad10 = Radiobutton(window, text='Комбинация', value=10, variable=selected)
rad11 = Radiobutton(window, text='Сылка', value=11, variable=selected)
rad12 = Radiobutton(window, text='Удалить', value=12, variable=selected)

rad10.place(x=1, y=420)
rad11.place(x=94, y=420)
rad12.place(x=153, y=420)

window.mainloop()

while True:
    keyboard.wait()




# def web_link1():
#     try:
#         with open("check_file.txt", "a", encoding="utf-8") as my_file:
#             if selected.get() == 1:
#                 sleep(0.25)
#                 key = keyboard.read_hotkey(suppress=False)
#                 key_list_1 = list(key)
#                 for i, item in enumerate(key_list_1, start=1):
#                     my_file.write(f"{i}: {item}\n")
#                  keyboard.add_hotkey("ctrl + win + NumLock", lambda: keyboard.press(key))
#                 lbl1_2.configure(text=key)
#             elif selected.get() == 2:
#                 my_file.write(f"{EnterText1.get()}\n")
#                 keyboard.add_hotkey("ctrl + win + NumLock", lambda: keyboard.release(webbrowser.open_new_tab(EnterText1.get())))
#                 lbl1_2.configure(text="Вы сохранили ссылку на клавишу")
#             elif selected.get() == 3:
#                 lbl1_2.configure(text="Вы удалили комбинацию/ссылку(и) на клавише")
#     except Exception as e:
#         messagebox.showerror("Ошибка", str(e))
